# è¯¥æ–‡æ¡£ä½¿ç”¨napi-rså®˜æ–¹æ¨¡ç‰ˆ
# `@napi-rs/package-template`

# Usage

1. Click **Use this template**.
2. **Clone** your project.
3. Run `pnpm install` to install dependencies.
4. Run `npx napi rename -n [name]` command under the project folder to rename your package.

## run 
- pnpm
- pnpm build
- pnpm test

---

# DTSP æŠ€æœ¯æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€ L6 è¡¨ç°å±‚ (Presentation) â”€â”€â”€â”€â”
â”‚ Electron + AntV X6 + Leptos      â”‚
â”œâ”€â”€â”€â”€ L5 åº”ç”¨å±‚ (Application) â”€â”€â”€â”€â”¤
â”‚ å·¥ç¨‹æ“ä½œ / Undo / Case ç®¡ç†     â”‚
â”œâ”€â”€â”€â”€ L4 ä»¿çœŸæœåŠ¡å±‚ (Simulation) â”€â”¤
â”‚ æ±‚è§£è°ƒåº¦ / æ”¶æ•›ç­–ç•¥ / ä»»åŠ¡ç®¡ç†  â”‚
â”œâ”€â”€â”€â”€ L3 é¢†åŸŸæ¨¡å‹å±‚ (Domain) â”€â”€â”€â”€â”€â”¤
â”‚ Unit / Stream / Network / Spec  â”‚
â”œâ”€â”€â”€â”€ L2 æ•°å­¦ä¸ç‰©æ€§å±‚ (Math):è¿™å—æœ‰é—®é¢˜ â”€â”€â”€â”€â”€â”¤
â”‚ ç‰©æ€§ / æ•°å€¼æ–¹æ³• / æ–¹ç¨‹æ±‚è§£      â”‚
â”œâ”€â”€â”€â”€ L1 åŸºç¡€è®¾æ–½å±‚ (Infra) â”€â”€â”€â”€â”€â”€â”¤
â”‚ DB / æ–‡ä»¶ / æ—¥å¿— / å¹¶å‘         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## L6ï¼šäº¤äº’ä¸è¡¨ç°å±‚ï¼ˆPresentation / Reactive UIï¼‰

**ç›®æ ‡**ï¼šé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„å·¥ä¸šçº§æµç¨‹äº¤äº’ç•Œé¢

### æŠ€æœ¯é€‰å‹

* **å®¹å™¨**ï¼šElectron
* **UI æ¡†æ¶**ï¼šLeptosï¼ˆWASMï¼‰
* **æµç¨‹ç¼–è¾‘å™¨**ï¼šAntV X6
* **æ„å»ºå·¥å…·**ï¼šVite

### æ ¸å¿ƒè®¾è®¡

* **å‰ç«¯å¼•æ“**

  * Leptosï¼ˆWASMï¼‰æ‰¿è½½æ ¸å¿ƒ UI çŠ¶æ€ä¸ä¸šåŠ¡é€»è¾‘
* **æ¸²æŸ“ä¼˜åŒ–ï¼ˆå¤§è§„æ¨¡æµç¨‹å›¾ï¼‰**

  * AntV X6 å¯ç”¨ Canvas / Virtual DOM
  * å¼•å…¥ **LODï¼ˆLevel of Detailï¼‰ç­–ç•¥**ï¼š

    * ğŸ” é«˜å€ç‡ï¼šä»…æ˜¾ç¤ºèŠ‚ç‚¹è½®å»“
    * ğŸ” ä¸­å€ç‡ï¼šæ˜¾ç¤ºè®¾å¤‡ç±»å‹
    * ğŸ¯ ä½å€ç‡ï¼ˆèšç„¦ï¼‰ï¼šæ˜¾ç¤ºå®æ—¶æµè‚¡å‚æ•°
* **çŠ¶æ€åŒæ­¥**

  * ä½¿ç”¨ Reactive Storage
  * UI ä»…è®¢é˜…å½“å‰ **Viewport å†…èŠ‚ç‚¹** çš„çŠ¶æ€å˜åŒ–

---

## L5ï¼šåº”ç”¨ç¼–æ’å±‚ï¼ˆApplication / Orchestrationï¼‰

**è§’è‰²å®šä½**ï¼šUI ä¸ä»¿çœŸå†…æ ¸ä¹‹é—´çš„â€œè¯­ä¹‰ç¼“å†²åŒºâ€

### æ ¸å¿ƒèŒè´£

* **è®¡ç®—å›¾æ„å»º**

  * å°†æµç¨‹èŠ‚ç‚¹è½¬åŒ–ä¸ºï¼š

    * Directed Acyclic Graphï¼ˆDAGï¼‰
    * æˆ– Cyclic Graphï¼ˆå« recycleï¼‰
* **å­ç³»ç»Ÿè§£è€¦**

  * è‡ªåŠ¨åˆ‡åˆ†å¤§ç³»ç»Ÿä¸ºå¤šä¸ª **Sub-domain**
  * æ¯ä¸ªå­ç³»ç»Ÿï¼š

    * ç‹¬ç«‹ Undo / Redo æ ˆ
    * ç‹¬ç«‹å‚æ•°äº‹åŠ¡
* **å·¥ç¨‹è¯­ä¹‰**

  * Case ç®¡ç†
  * å‚æ•°ä¿®æ”¹äº‹åŠ¡
  * æ“ä½œçº§ Undo / Redoï¼ˆéæ•°å€¼çº§ï¼‰

---

## L4ï¼šä»¿çœŸæœåŠ¡å±‚ï¼ˆSimulation Serviceï¼‰

**ç›®æ ‡**ï¼šé«˜å¯æ‰©å±•ã€é«˜å¯é çš„æ±‚è§£è°ƒåº¦ç³»ç»Ÿ

### åŠŸèƒ½æ¨¡å—

* Tearing
* Recycle å¤„ç†
* æ”¶æ•›ç­–ç•¥
* è®¡ç®—é¡ºåºç®¡ç†
* é”™è¯¯ä¸å¼‚å¸¸å¤„ç†

### åˆ†å¸ƒå¼è®¾è®¡

* **æ±‚è§£æ¨¡å¼**

  * åŸºäº Rust + Tokio çš„ Task Worker æ¨¡å‹
  * æ¨ªå‘æ‰©å±•ï¼ˆå¤šæ ¸ / å¤šèŠ‚ç‚¹ï¼‰
* **çƒ­å¯åŠ¨ï¼ˆHot Startï¼‰**

  * ä¿å­˜å†å²æ”¶æ•›è§£
  * ä½œä¸ºæ–°å·¥å†µ Initial Guess
* **è´Ÿè½½å‡è¡¡**

  * æ ¹æ®å­ç³»ç»Ÿè§„æ¨¡ä¸éçº¿æ€§ç¨‹åº¦
  * åŠ¨æ€åˆ†é…è®¡ç®—èµ„æº

---

## L3ï¼šé¢†åŸŸæ¨¡å‹å±‚ï¼ˆDomain Modelï¼‰ã€æ ¸å¿ƒå±‚ã€‘

**æ•°å­—å­ªç”Ÿçš„è¯­ä¹‰æ ¸å¿ƒ**

### æ ¸å¿ƒå¯¹è±¡

* `UnitOperation`
* `MaterialStream`
* `EnergyStream`
* `Specification`
* `Network`

### ç»Ÿä¸€æ¥å£è§„èŒƒ

* å¼ºåˆ¶æ‰§è¡Œ **Unit Model Interfaceï¼ˆUMIï¼‰**

```rust
// L3
trait UnitOperation {
    fn residual(&self, x: &[f64], r: &mut [f64]);
    fn jacobian(&self, x: &[f64], entries: &mut Vec<(usize, usize, f64)>);
}

// L2
trait NonlinearProblem {
    fn assemble_residual(&self, x: &[f64], r: &mut [f64]);
    fn assemble_jacobian(&self, x: &[f64], j: &mut SparseMatrix);
}

```

### çŠ¶æ€æ¨¡å‹

* **state**ï¼šå¯è®¡ç®—å˜é‡ï¼ˆè‡ªç”±åº¦ï¼‰
* **spec**ï¼šçº¦æŸæ¡ä»¶ï¼ˆè®¾è®¡è§„æ ¼ï¼‰

### å‚æ•°ä½“ç³»

* **Global Parameter Space**

  * æ”¯æŒæ•°ä¸‡ä¸ªå‚æ•°
  * é«˜æ•ˆç´¢å¼• / æ‰¹é‡ä¿®æ”¹

---

## L2ï¼šæ•°å­¦ä¸ç‰©æ€§å±‚ï¼ˆMath & Thermoï¼‰è¿™å—æœ‰é—®é¢˜ï¼Œè¯¥è®¾è®¡ä¸æ˜æœ—

**ç›®æ ‡**ï¼šå·¥ä¸šçº§é«˜æ€§èƒ½æ•°å€¼å†…æ ¸ï¼ˆHPCï¼‰

### åŠŸèƒ½æ¨¡å—

* æ•°å€¼æ–¹æ³•
* çƒ­ç‰©æ€§è®¡ç®—
* éçº¿æ€§æ–¹ç¨‹ç»„
* Jacobian ç”Ÿæˆ

### æŠ€æœ¯ç‰¹æ€§

* **ç¨€ç–çŸ©é˜µæ±‚è§£**

  * KLU
  * SuperLU
  * Intel MKL PARDISO
* **è‡ªåŠ¨å¾®åˆ†ï¼ˆADï¼‰**

  * Rust è‡ªåŠ¨å¾®åˆ†åº“
  * è‡ªåŠ¨ç”Ÿæˆ Jacobian
  * ç›¸æ¯”æ•°å€¼å·®åˆ†ï¼š

* **å¤šç²¾åº¦æ”¯æŒ**

  * FP32 / FP64 åŠ¨æ€åˆ‡æ¢
* **å¤–éƒ¨é›†æˆ**

  * Fortran / C æ•°å€¼åº“
  * å¤–éƒ¨ Property Package

---

## L1ï¼šåŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructureï¼‰

**ç›®æ ‡**ï¼šç¨³å®šã€å¯ç»´æŠ¤ã€Rust-native

### æ¨¡å—ä¸æŠ€æœ¯é€‰å‹

| æ¨¡å—  | æŠ€æœ¯                 |
| --- | ------------------ |
| DB  | SQLite             |
| ORM | SeaORM             |
| æ—¥å¿—  | tracing            |
| å¹¶å‘  | Rust async + rayon |
| æ–‡ä»¶  | serde + è‡ªå®šä¹‰æ ¼å¼      |

### å­˜å‚¨ä¸é€šä¿¡

* **é«˜é€Ÿé€šä¿¡æ€»çº¿**

  * gRPC
  * Zenohï¼ˆRust-nativeï¼Œé€‚åˆé«˜é¢‘æ•°æ®æµï¼‰
* **æ•°æ®å­˜å‚¨**

  * Parquetï¼ˆOLAP / ç»“æœåˆ†æï¼‰
  * RocksDBï¼ˆä¸´æ—¶å¿«ç…§ / çƒ­çŠ¶æ€ï¼‰
  * sqlite æœ¬åœ°æ•°æ®å­˜å‚¨
---
